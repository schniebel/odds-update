# Subnet group (private subnets)
apiVersion: rds.aws.upbound.io/v1beta1
kind: SubnetGroup
metadata:
  name: odds-pg-subnets
spec:
  forProvider:
    region: us-east-1
    description: Private subnets for odds Postgres
    subnetIdRefs:
      - name: odds-update-private-a
      - name: odds-update-private-b
      - name: odds-update-private-c
  providerConfigRef:
    name: aws-default

---

apiVersion: rds.aws.upbound.io/v1beta1
kind: Instance
metadata:
  name: odds-pg
spec:
  forProvider:
    region: us-east-1
    engine: postgres
    engineVersion: "16"
    dbInstanceClass: db.m6g.large
    multiAZ: true
    allocatedStorage: 100
    storageType: gp3
    storageEncrypted: true
    username: oddsadmin
    skipFinalSnapshotBeforeDeletion: true
    applyImmediately: true
    dbSubnetGroupNameRef:
      name: odds-pg-subnets
    vpcSecurityGroupIDRefs:
      - name: odds-db-sg
    parameterGroupNameRef:
      name: odds-pg-params
    publiclyAccessible: false
    autoMinorVersionUpgrade: true
    backupRetentionPeriod: 7
  writeConnectionSecretToRef:
    name: odds-pg-conn
    namespace: crossplane-system
  providerConfigRef:
    name: aws-default
